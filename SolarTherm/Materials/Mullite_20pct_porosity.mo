within SolarTherm.Materials;
//Mullite properties 298.15 < T (K) < 1500. Stoichiometry of 3Al2O3.2SiO2 ~72wt% is assumed which is typical of sintered mullite. 
package Mullite_20pct_porosity
  extends SolarTherm.Materials.PartialMaterial(MM = 426.0524e-3, T_melt = 1840.0+273.15, cost = 0.55);
  import SolarTherm.Utilities.Interpolation.Interpolate1D;
  
  redeclare model State "A model which calculates state and properties"
    SI.SpecificEnthalpy h "Specific Enthalpy wrt 298.15K (J/kg)";
    SI.Temperature T "Temperature (K)";
    Real f "Liquid Mass Fraction";
    SI.Density rho "Density (kg/m3)";
    SI.ThermalConductivity k "Thermal conductivity (W/mK)";
  equation
    f = 0.0;
    h = h_Tf(T, 0);
    rho = rho_Tf(T, 0);
    k = k_Tf(T, 0);
  end State;

  redeclare function h_Tf "find specific enthalpy from Temperature"
    input SI.Temperature T "Absolute temperature (K)";
    input Real f "Liquid mass fraction";
    output SI.SpecificEnthalpy h "Specific Enthalpy (J/kg)";
  protected
    Real T_data[122] = {298.15, 300.00, 310.00, 320.00, 330.00, 340.00, 350.00, 360.00, 370.00, 380.00, 390.00, 400.00, 410.00, 420.00, 430.00, 440.00, 450.00, 460.00, 470.00, 480.00, 490.00, 500.00, 510.00, 520.00, 530.00, 540.00, 550.00, 560.00, 570.00, 580.00, 590.00, 600.00, 610.00, 620.00, 630.00, 640.00, 650.00, 660.00, 670.00, 680.00, 690.00, 700.00, 710.00, 720.00, 730.00, 740.00, 750.00, 760.00, 770.00, 780.00, 790.00, 800.00, 810.00, 820.00, 830.00, 840.00, 850.00, 860.00, 870.00, 880.00, 890.00, 900.00, 910.00, 920.00, 930.00, 940.00, 950.00, 960.00, 970.00, 980.00, 990.00, 1000.00, 1010.00, 1020.00, 1030.00, 1040.00, 1050.00, 1060.00, 1070.00, 1080.00, 1090.00, 1100.00, 1110.00, 1120.00, 1130.00, 1140.00, 1150.00, 1160.00, 1170.00, 1180.00, 1190.00, 1200.00, 1210.00, 1220.00, 1230.00, 1240.00, 1250.00, 1260.00, 1270.00, 1280.00, 1290.00, 1300.00, 1310.00, 1320.00, 1330.00, 1340.00, 1350.00, 1360.00, 1370.00, 1380.00, 1390.00, 1400.00, 1410.00, 1420.00, 1430.00, 1440.00, 1450.00, 1460.00, 1470.00, 1480.00, 1490.00, 1500.00};
    Real h_data[122] = {-597.5, 818.1, 8593.1, 16564.3, 24718.3, 33043.0, 41527.7, 50162.7, 58939.4, 67849.8, 76886.9, 86044.2, 95315.6, 104695.8, 114179.7, 123762.8, 133440.7, 143209.4, 153065.4, 163005.1, 173025.3, 183123.0, 193295.3, 203539.7, 213853.6, 224234.7, 234680.6, 245189.3, 255758.7, 266386.9, 277072.2, 287812.6, 298606.7, 309452.7, 320349.2, 331294.6, 342287.7, 353326.9, 364411.1, 375539.0, 386709.3, 397920.9, 409172.7, 420463.5, 431792.4, 443158.3, 454560.3, 465997.3, 477468.4, 488972.9, 500509.7, 512078.1, 523677.2, 535306.2, 546964.4, 558651.0, 570365.3, 582106.6, 593874.2, 605667.4, 617485.5, 629328.0, 641194.3, 653083.6, 664995.5, 676929.4, 688884.7, 700861.0, 712857.6, 724874.0, 736909.9, 748964.7, 761037.9, 773129.1, 785237.9, 797363.9, 809506.5, 821665.5, 833840.5, 846031.1, 858236.9, 870457.5, 882692.7, 894942.2, 907205.5, 919482.4, 931772.7, 944076.0, 956392.1, 968720.7, 981061.6, 993414.5, 1005779.2, 1018155.6, 1030543.3, 1042942.3, 1055352.3, 1067773.1, 1080204.7, 1092646.8, 1105099.3, 1117562.0, 1130035.0, 1142517.9, 1155010.9, 1167513.7, 1180026.2, 1192548.5, 1205080.4, 1217621.9, 1230172.9, 1242733.5, 1255303.5, 1267883.1, 1280472.1, 1293070.6, 1305678.6, 1318296.1, 1330923.2, 1343559.9, 1356206.2, 1368862.3};
  algorithm
    h := Modelica.Math.Vectors.interpolate(T_data,h_data,T);
  end h_Tf;

  redeclare function rho_Tf "find density from temperature"
    input SI.Temperature T "Absolute temperature (K)";
    input Real f "Liquid mass fraction";
    output SI.Density rho "Density (kg/m3)";
  algorithm
    rho := 2560.0;
  end rho_Tf;

  function k_Tf "find thermal conductivity from temperature"
    input SI.Temperature T;
    input Real f;
    output SI.ThermalConductivity k;
  protected
    Real T_data[8] = {373.15, 473.15, 673.15, 873.15, 1073.15, 1273.15, 1473.15, 1673.15};
    Real k_data[8] = {4.85344, 4.35136, 3.68192, 3.3472, 3.17984, 3.01248, 3.01248, 3.01248};
  algorithm
    k := Modelica.Math.Vectors.interpolate(T_data,k_data,T);
  end k_Tf;

  function Tf_h "Find temperature and liquid fraction from temperature"
    input SI.SpecificEnthalpy h "Specific Enthalpy (J/kg)";
    output SI.Temperature T "Absoulte temperature (K)";
    output Real f "mass liquid fraction";
protected
    Real T_data[122] = {298.15, 300.00, 310.00, 320.00, 330.00, 340.00, 350.00, 360.00, 370.00, 380.00, 390.00, 400.00, 410.00, 420.00, 430.00, 440.00, 450.00, 460.00, 470.00, 480.00, 490.00, 500.00, 510.00, 520.00, 530.00, 540.00, 550.00, 560.00, 570.00, 580.00, 590.00, 600.00, 610.00, 620.00, 630.00, 640.00, 650.00, 660.00, 670.00, 680.00, 690.00, 700.00, 710.00, 720.00, 730.00, 740.00, 750.00, 760.00, 770.00, 780.00, 790.00, 800.00, 810.00, 820.00, 830.00, 840.00, 850.00, 860.00, 870.00, 880.00, 890.00, 900.00, 910.00, 920.00, 930.00, 940.00, 950.00, 960.00, 970.00, 980.00, 990.00, 1000.00, 1010.00, 1020.00, 1030.00, 1040.00, 1050.00, 1060.00, 1070.00, 1080.00, 1090.00, 1100.00, 1110.00, 1120.00, 1130.00, 1140.00, 1150.00, 1160.00, 1170.00, 1180.00, 1190.00, 1200.00, 1210.00, 1220.00, 1230.00, 1240.00, 1250.00, 1260.00, 1270.00, 1280.00, 1290.00, 1300.00, 1310.00, 1320.00, 1330.00, 1340.00, 1350.00, 1360.00, 1370.00, 1380.00, 1390.00, 1400.00, 1410.00, 1420.00, 1430.00, 1440.00, 1450.00, 1460.00, 1470.00, 1480.00, 1490.00, 1500.00};
    Real h_data[122] = {-597.5, 818.1, 8593.1, 16564.3, 24718.3, 33043.0, 41527.7, 50162.7, 58939.4, 67849.8, 76886.9, 86044.2, 95315.6, 104695.8, 114179.7, 123762.8, 133440.7, 143209.4, 153065.4, 163005.1, 173025.3, 183123.0, 193295.3, 203539.7, 213853.6, 224234.7, 234680.6, 245189.3, 255758.7, 266386.9, 277072.2, 287812.6, 298606.7, 309452.7, 320349.2, 331294.6, 342287.7, 353326.9, 364411.1, 375539.0, 386709.3, 397920.9, 409172.7, 420463.5, 431792.4, 443158.3, 454560.3, 465997.3, 477468.4, 488972.9, 500509.7, 512078.1, 523677.2, 535306.2, 546964.4, 558651.0, 570365.3, 582106.6, 593874.2, 605667.4, 617485.5, 629328.0, 641194.3, 653083.6, 664995.5, 676929.4, 688884.7, 700861.0, 712857.6, 724874.0, 736909.9, 748964.7, 761037.9, 773129.1, 785237.9, 797363.9, 809506.5, 821665.5, 833840.5, 846031.1, 858236.9, 870457.5, 882692.7, 894942.2, 907205.5, 919482.4, 931772.7, 944076.0, 956392.1, 968720.7, 981061.6, 993414.5, 1005779.2, 1018155.6, 1030543.3, 1042942.3, 1055352.3, 1067773.1, 1080204.7, 1092646.8, 1105099.3, 1117562.0, 1130035.0, 1142517.9, 1155010.9, 1167513.7, 1180026.2, 1192548.5, 1205080.4, 1217621.9, 1230172.9, 1242733.5, 1255303.5, 1267883.1, 1280472.1, 1293070.6, 1305678.6, 1318296.1, 1330923.2, 1343559.9, 1356206.2, 1368862.3};
  algorithm
    T := Modelica.Math.Vectors.interpolate(h_data,T_data,h);
    f := 0.0;
  end Tf_h;
end Mullite_20pct_porosity;